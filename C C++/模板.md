---
title: æ¨¡æ¿
aliases: 
author: SprInec
date: 2024-12-12
update: 2024-12-13 18:43:41
reference:
  - é»‘é©¬ç¨‹åºå‘˜C++æ•™ç¨‹
tags: cpp, æ³›å‹ç¼–ç¨‹
---
# æ¨¡æ¿

### 1. æ¨¡æ¿çš„æ¦‚å¿µ

æ¨¡æ¿å°±æ˜¯å»ºç«‹**é€šç”¨çš„æ¨¡å…·**ï¼Œå¤§å¤§æé«˜å¤ç”¨æ€§ã€‚

æ¨¡æ¿çš„ç‰¹ç‚¹ï¼š
- æ¨¡æ¿ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ¨¡å…·
- æ¨¡æ¿çš„é€šç”¨æ€§å¹¶ä¸æ˜¯ä¸‡èƒ½çš„

### 2. å‡½æ•°æ¨¡æ¿

- C++ å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ä¸º**æ³›å‹ç¼–ç¨‹**ï¼Œä¸»è¦åˆ©ç”¨çš„æŠ€æœ¯å°±æ˜¯æ¨¡æ¿
- C++ æä¾›ä¸¤ç§æ¨¡æ¿æœºåˆ¶
	- å‡½æ•°æ¨¡æ¿
	- ç±»æ¨¡æ¿

#### 2.1 å‡½æ•°æ¨¡æ¿è¯­æ³•

å‡½æ•°æ¨¡æ¿çš„ä½œç”¨ï¼šå»ºè®®ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°è¿”å›å€¼ç±»å‹å’Œå½¢å‚ç±»å‹å¯ä»¥ä¸å…·ä½“æŒ‡å®šï¼Œç”¨ä¸€ä¸ª**è™šæ‹Ÿçš„ç±»å‹**æ¥ä»£è¡¨ã€‚

è¯­æ³•ï¼š
```cpp title:æ¨¡æ¿è¯­æ³•
template<typename T>
å‡½æ•°å£°æ˜æˆ–å®šä¹‰
```

- `template` - å£°æ˜æˆ–åˆ›å»ºæ¨¡æ¿
- `typename` - è¡¨æ˜å…¶åé¢çš„å­—ç¬¦æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨ `class` ä»£æ›¿
- `T` - é€šç”¨çš„æ•°æ®ç±»å‹ï¼Œåç§°å¯ä»¥æ›¿æ¢ï¼Œé€šå¸¸ä¸ºå¤§å†™å­—æ¯

```cpp title:åˆ©ç”¨æ¨¡æ¿å®ç°å˜é‡äº¤æ¢ hl:1-7,15,18
template<typename T>
void userSwap(T &a, T &b)
{
	T temp = a;
	a = b;
	b = T;
}

void test_func()
{
	int a = 10;
	int b = 20;

	/* 1. è‡ªåŠ¨ç±»å‹æ¨å¯¼ */
	userSwap(a, b);

	/* 2. æ˜¾æ€§æŒ‡å®šç±»å‹ */
	userSwap<int>(a, b);
}
```

>[!Summary] 
> 
> - å‡½æ•°æ¨¡æ¿åˆ©ç”¨å…³é”®å­— `template`
> - ä½¿ç”¨å‡½æ•°æ¨¡æ¿æœ‰ä¸¤ç§æ–¹å¼ï¼š
> 	- è‡ªåŠ¨ç±»å‹æ¨å¯¼
> 	- æ˜¾æ€§æŒ‡å®šç±»å‹
> - æ¨¡æ¿çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜å¤ç”¨æ€§ï¼Œå°†ç±»å‹å‚æ•°åŒ–

#### 2.2 å‡½æ•°æ¨¡æ¿æ³¨æ„äº‹é¡¹

1. è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œå¿…é¡»æ¨å¯¼å‡ºä¸€è‡´çš„æ•°æ®ç±»å‹ `T` ï¼Œæ‰å¯ä»¥ä½¿ç”¨
2. æ¨¡æ¿å¿…é¡»è¦ç¡®å®šå‡º `T` çš„æ•°æ®ç±»å‹æ‰å¯ä»¥ä½¿ç”¨

```cpp error:13,24 fix:25
template<class T>
void userSwap(T &a, T &b)
{
	T temp = a;
	a = b;
	b = temp;
}

void test_func1()
{
	int a = 10;
	char c = 'c';
	userSwap(a, c); // âš  ERROR: æ•°æ®ç±»å‹ä¸ä¸€è‡´
}

template<class T>
void print_func()
{
	cout << "hello world" << endl;
}

void test_func2()
{
	print_func(); // âš  ERROR: æ— æ³•ç¡®å®šæ•°æ®ç±»å‹
	print_func<int>();
}
```

#### 2.3 æ™®é€šå‡½æ•°ä¸å‡½æ•°æ¨¡æ¿çš„åŒºåˆ«

- æ™®é€šå‡½æ•°è°ƒç”¨æ—¶å¯ä»¥å‘ç”Ÿè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼ç±»å‹è½¬æ¢ï¼‰
- å‡½æ•°æ¨¡æ¿è°ƒç”¨æ—¶ï¼š
	- å¦‚æœåˆ©ç”¨è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œä¸ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢
	- å¦‚æœåˆ©ç”¨æ˜¾æ€§æŒ‡å®šç±»å‹çš„æ–¹å¼ï¼Œå¯ä»¥å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢

#### 2.4 æ™®é€šå‡½æ•°å’Œå‡½æ•°æ¨¡æ¿çš„è°ƒç”¨è§„åˆ™

1. å¦‚æœå‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°éƒ½å¯ä»¥å®ç°ï¼Œä¼˜å…ˆè°ƒç”¨æ™®é€šå‡½æ•°
2. å¯ä»¥é€šè¿‡ç©ºæ¨¡æ¿å‚æ•°åˆ—è¡¨æ¥å¼ºåˆ¶è°ƒç”¨å‡½æ•°æ¨¡æ¿
3. å‡½æ•°æ¨¡æ¿ä¹Ÿå¯ä»¥å‘ç”Ÿé‡è½½
4. å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿæ›´å¥½çš„åŒ¹é…ï¼Œä¼˜å…ˆè°ƒç”¨å‡½æ•°æ¨¡æ¿

```cpp hl:1,6-7,13-14,25,28,36
void userPrint(int a, int b)
{
	cout << "Normal function" << endl;
}

template<typename T>
void userPrint(T a, T b)
{
	cout << "template function" << endl;
}

/* 3. å‡½æ•°æ¨¡æ¿é‡è½½ */
template<typename T>
void userPrint(T a, T b, T c)
{
	cout << "template function" << endl;
}

void test_func()
{
	int a = 10;
	int b = 20;

	/* 1. ä¼˜å…ˆè°ƒç”¨æ™®é€šå‡½æ•° */
	userPrint(a, b); // output: Normal function

	/* 2. é€šè¿‡ç©ºæ¨¡æ¿å‚æ•°åˆ—è¡¨å¼ºåˆ¶è°ƒç”¨å‡½æ•°æ¨¡æ¿ */
	userPrint<>(a, b); // output: template function

	userPrint(a, b ,100); // output: template function

	/* 4. å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿæ›´å¥½çš„åŒ¹é…ï¼Œä¼˜å…ˆè°ƒç”¨å‡½æ•°æ¨¡æ¿ */
	char c = 'a';
	char d = 'b';

	userPrint(c, d); // output: template function
	
}
```

>[!Summary] 
> 
> å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæä¾›äº†å‡½æ•°æ¨¡æ¿ï¼Œæœ€å¥½å°±ä¸è¦æä¾›æ™®é€šå‡½æ•°ï¼Œå¦åˆ™å®¹æ˜“å‡ºç°äºŒä¹‰æ€§

#### 2.5 æ¨¡æ¿çš„å±€é™æ€§

æ¨¡æ¿çš„é€šç”¨æ€§å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæœ‰äº›ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œéœ€è¦ç”¨å…·ä½“åŒ–çš„æ–¹å¼åšç‰¹æ®Šå®ç°

```cpp hl:30
class Person
{
public:
	Person(string name, int age)
	{
		this->m_name = name;
		this->m_age = age;
	}

public:
	string m_name;
	int m_age;
};

template<typename T>
bool userCompare(T &a, T &b)
{
	if (a == b)
	{
		return true;
	}
	else
	{
		return false;
	}
}

/* ğŸ’¡åˆ©ç”¨å…·ä½“åŒ–ç‰ˆæœ¬å®ç°ä»£ç ï¼Œå…·ä½“åŒ–ä¼˜å…ˆè°ƒç”¨ */
/* ğŸ’¡ä¹Ÿå¯ç”¨è¿ç®—ç¬¦é‡è½½è§£å†³é—®é¢˜ */
template<> bool userCompare(Person &p1, Person &p2)
{
	if (p1.m_name == p2.m_name && p1.m_age == p2.m_age)
	{
		return true;
	}
	else
	{
		return false;
	}
}

void test_func()
{
	Person p1("Tom", 10);
	Person p2("Tom", 10);

	bool ret = userCompare(p1, p2);
	cout << ret << endl;
}
```

>[!Summary] 
> 
> - åˆ©ç”¨å…·ä½“åŒ–çš„æ¨¡æ¿ï¼Œå¯ä»¥è§£å†³è‡ªå®šä¹‰ç±»å‹çš„é€šç”¨åŒ–
> - å­¦ä¹ æ¨¡æ¿å¹¶ä¸æ˜¯ä¸ºäº†å†™æ¨¡æ¿ï¼Œè€Œæ˜¯åœ¨ STL ä¸­èƒ½å¤Ÿè¿ç”¨ç³»ç»Ÿæä¾›çš„æ¨¡æ¿

### 2. ç±»æ¨¡æ¿
#### 2.1 ç±»æ¨¡æ¿è¯­æ³•

ç±»æ¨¡æ¿ä½œç”¨ï¼šå»ºç«‹ä¸€ä¸ªé€šç”¨ç±»ï¼Œç±»ä¸­çš„æˆå‘˜æ•°æ®ç±»å‹å¯ä»¥ä¸å…·ä½“æŒ‡å®šï¼Œç”¨ä¸€ä¸ª**è™šæ„çš„ç±»å‹**æ¥ä»£è¡¨ã€‚

è¯­æ³•ï¼š
```cpp
template<class T1, class T2, ...>
ç±»å®šä¹‰
```

- `template` - å£°æ˜æˆ–åˆ›å»ºæ¨¡æ¿
- `class` - è¡¨æ˜å…¶åé¢çš„å­—ç¬¦æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥ç”¨ `typename` ä»£æ›¿
- `T1,T2,...` - é€šç”¨çš„æ•°æ®ç±»å‹ï¼Œåç§°å¯ä»¥æ›¿æ¢ï¼Œé€šå¸¸ä¸ºå¤§å†™å­—æ¯

```cpp hl:1,22
template<class NameType, class AgeType>
class Person
{
public:
	Person(NameType name, AgeType age)
	{
		this->m_name = name;
		this->m_age = age;
	}
	void print_content()
	{
		cout << m_name << m_age << endl;
	}
	
public:
	NameType m_name;
	AgeType m_age;
};

void test_func()
{
	Person<string, int> p("Mon", 19);
	p.print_content();
}
```

#### 2.2 ç±»æ¨¡æ¿ä¸å‡½æ•°æ¨¡æ¿çš„åŒºåˆ«

1. ç±»æ¨¡æ¿æ²¡æœ‰è‡ªåŠ¨ç±»å‹æ¨å¯¼çš„ä½¿ç”¨æ–¹å¼
2. ç±»æ¨¡æ¿åœ¨æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸­å¯ä»¥æœ‰é»˜è®¤å‚æ•°

```cpp error:22 hl:5,23
template<class NameType, class AgeType>
class Person
{
public:
	Person(NameType name, AgeType age = int) // å¯æŒ‡å®šé»˜è®¤ç±»å‹
	{
		this->m_name = name;
		this->m_age = age;
	}
	void print_content()
	{
		cout << m_name << m_age << endl;
	}
	
public:
	NameType m_name;
	AgeType m_age;
};

void test_func()
{
	Person p("Mon", 19); // âš  ERROR: ç±»æ¨¡æ¿ä¸æ”¯æŒè‡ªåŠ¨ç±»å‹æ¨å¯¼
	Person p("Mon");
	p.print_content();
}
```

>[!Summary] 
> 
> - ç±»æ¨¡æ¿ä½¿ç”¨æ—¶åªèƒ½ç”¨æ˜¾æ€§æŒ‡å®šç±»å‹çš„æ–¹å¼
> - ç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨å¯ä»¥æœ‰é»˜è®¤å‚æ•°

#### 2.3 ç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°çš„åˆ›å»ºæ—¶æœº

- æ™®é€šç±»ä¸­çš„æˆå‘˜å‡½æ•°ä¸€å¼€å§‹å°±å¯ä»¥åˆ›å»º
- ç±»æ¨¡æ¿ä¸­çš„æˆå‘˜å‡½æ•°åœ¨è°ƒç”¨æ—¶æ‰åˆ›å»º

```cpp hl:20-21 error:29
class Person1
{
public:
	void showPerson1(){}
};

class Person2
{
public:
	void showPerson2(){}
};

template<class T>
class userClass
{
public:
	T obj;
	
	/* ç¼–è¯‘æ—¶ä¸ä¼šæŠ¥é”™ */
	void func1() { obj.showPerson1(); }
	void func2() { obj.showPerson2(); }
};

void test_func()
{
	userClass<Person1> u;

	u.func1();
	/* åœ¨å‡½æ•°è°ƒç”¨æ—¶æ‰ä¼šæ£€æŸ¥åŠæŠ¥é”™ */
	u.func2(); // âš  ERROR: Person1 æ— æˆå‘˜å‡½æ•° func2()
}

```

#### 2.4 ç±»æ¨¡æ¿å¯¹è±¡åšå‡½æ•°å‚æ•°

ç±»æ¨¡æ¿å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œå‘å‡½æ•°ä¼ å‚ä¸€å…±æœ‰ä¸‰ç§ä¼ å…¥æ–¹å¼

1. æŒ‡å®šä¼ å…¥ç±»å‹ - ç›´æ¥æ˜¾æ€§æŒ‡å®šå¯¹è±¡çš„æ•°æ®ç±»å‹
2. å‚æ•°æ¨¡æ¿åŒ– - å°†å¯¹è±¡ä¸­çš„å‚æ•°å˜ä¸ºæ¨¡æ¿è¿›è¡Œä¼ é€’
3. æ•´ä¸ªç±»æ¨¡æ¿åŒ– - å°†è¿™ä¸ªå¯¹è±¡ç±»å‹æ¨¡æ¿åŒ–è¿›è¡Œä¼ é€’

```cpp hl:21,28,33-34,49-50 fix:38-39,53
template<class NameType, class AgeType>
class Person
{
public:
	Person(NameType name, AgeType age)
	{
		this->m_name = name;
		this->m_age = age;
	}
	void print_content()
	{
		cout << m_name << m_age << endl;
	}
	
public:
	NameType m_name;
	AgeType m_age;
};

/* 1.æŒ‡å®šä¼ å…¥ç±»å‹ */
void printPerson1(Person<string,int>&p)
{
	p.print_content();
}

void test_func1()
{
	Person<string, int> p("Mon", 10);
	printPerson1(p);
}

/* 2.å‚æ•°æ¨¡æ¿åŒ– */
template<class T1, class T2>
void printPerson2(Person1<T1, T2>&p)
{
	p.print_content();
	/* æŸ¥çœ‹è‡ªåŠ¨æ¨å¯¼çš„æ•°æ®ç±»å‹ */
	cout << "T1çš„ç±»å‹: " << typeid(T1).name() << endl;
	cout << "T2çš„ç±»å‹: " << typeid(T2).name() << endl;
}

void test_func2()
{
	Person<string, int> p("Mon", 10);
	printPerson1(p);
}

/* 3.æ•´ä¸ªç±»æ¨¡æ¿åŒ– */
template<class T>
void printPerson3(T &p)
{
	p.print_content();
	cout << "Tçš„æ•°æ®ç±»å‹:" << typeid(T).name() << endl;
}

void test_func3()
{
	Person<string, int> p("Mon", 10);
	printPerson1(p);
}
```

>[!Summary] 
> 
> - é€šè¿‡ç±»æ¨¡æ¿åˆ›å»ºçš„å¯¹è±¡ï¼Œå¯ä»¥æœ‰ä¸‰ç§æ–¹å¼å‘å‡½æ•°ä¸­è¿›è¡Œä¼ å‚
> - ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„æ—¶ç¬¬ä¸€ç§ï¼ŒæŒ‡å®šä¼ å…¥çš„ç±»å‹

#### 2.5 ç±»æ¨¡æ¿ä¸ç»§æ‰¿

å½“ç±»æ¨¡æ¿ç¢°åˆ°ç»§æ‰¿æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- å½“å­ç±»ç»§æ‰¿çš„çˆ¶ç±»æ˜¯ä¸€ä¸ªç±»æ¨¡æ¿æ—¶ï¼Œå­ç±»åœ¨å£°æ˜çš„æ—¶å€™ï¼Œè¦æŒ‡å®šå‡ºçˆ¶ç±»ä¸­ `T` çš„ç±»å‹
- å¦‚è‹¥ä¸æŒ‡å®šï¼Œç¼–è¯‘å™¨æ— æ³•ç»™å­ç±»åˆ†é…å†…å­˜
- å¦‚æœæƒ³çµæ´»æŒ‡å®šå‡ºçˆ¶ç±»ä¸­ `T` çš„ç±»å‹ï¼Œå­ç±»ä¹Ÿéœ€è¦å˜ä¸ºç±»æ¨¡æ¿

```cpp hl:9,15-16,29
template<class T>
class Base
{
public:
	T m;
};

/* 1.æŒ‡å®šæ•°æ®ç±»å‹ */
class Son1: public Base<int>
{

};

/* 2.å­ç±»å£°æ˜ä¸ºæ¨¡æ¿ */
template<class T1, class T2>
class Son2: public Base<T2>
{
public:
	Son2()
	{
		cout << "type of T1:" << typeid(T1).name() << endl;
		cout << "type of T2:" << typeid(T2).name() << endl;
	}
	T1 obj;
};

void test_func()
{
	Son2<int, char> s2;
}
```

>[!Summary] 
> 
> å¦‚æœçˆ¶ç±»æ˜¯ç±»æ¨¡æ¿ï¼Œå­ç±»éœ€è¦æŒ‡å®šå‡ºçˆ¶ç±»ä¸­çš„ `T` çš„æ•°æ®ç±»å‹

#### 2.6 ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„ç±»å¤–å®ç°

```cpp hl:13-14,20,21
template<class T1, class T2>
class Person
{
public:
	Person(T1 name, T2 age);
	void showPerson();

public:
	T1 m_name;
	T2 m_age;
};

template<class T1, class T2>
Person<T1, T2>::Person(T1 name, T2 age)
{
	this->m_name = name;
	this->m_age = age;
}

template<class T1, class T2>
void Person<T1, T2>::showPerson()
{
	cout << this->m_name << this->m_age << endl;
}
```

>[!Summary] 
> 
> ç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°ç±»å¤–å®ç°æ—¶ï¼Œéœ€è¦åŠ ä¸Šæ¨¡æ¿å‚æ•°åˆ—è¡¨

#### 2.7 ç±»æ¨¡æ¿åˆ†æ–‡ä»¶ç¼–å†™

é—®é¢˜
- ç±»æ¨¡æ¿ä¸­<u>æˆå‘˜å‡½æ•°åˆ›å»ºæ—¶æœºæ˜¯åœ¨è°ƒç”¨é˜¶æ®µ</u>ï¼Œå¯¼è‡´åˆ†æ–‡ä»¶ç¼–å†™æ—¶<u>é“¾æ¥ä¸åˆ°</u>

è§£å†³æ–¹æ³•ï¼š
1. ç›´æ¥åŒ…å« `.cpp` æºæ–‡ä»¶
2. å°†å£°æ˜å’Œå®ç°å†™åˆ°åŒä¸€æ–‡ä»¶ä¸­ï¼Œå¹¶æ›´æ”¹åç¼€åä¸º `.hpp` ï¼Œ`.hpp` æ˜¯çº¦å®šçš„åç§°ï¼Œå¹¶éå¼ºåˆ¶

æ–¹å¼ä¸€ï¼šç›´æ¥åŒ…å«æºç 

```cpp title:person.h fix:1
#pragram once
#include <iostream>
using namespace std;

template<class T1, class T2>
class Person
{
public:
	Person(T1 name, T2 age);
	void showPerson();

public:
	T1 m_name;
	T2 m_age;
};
```

```cpp title:person.cpp
#include "person.h"

template<class T1, class T2>
Person<T1, T2>::Person(T1 name, T2 age)
{
	this->m_name = name;
	this->m_age = age;
}

template<class T1, class T2>
void Person<T1, T2>::showPerson()
{
	cout << this->m_name << this->m_age << endl;
}
```

```cpp title:test.cpp hl:4
#include <iostream>
using namespace std;

#include "person.cpp"

void test_func()
{
	Person<string, int> p("Mon", 10);
	p.showPerson();
}

int main()
{
	test_func();
	return 0;
}
```

æ–¹å¼äºŒï¼ˆå¸¸ç”¨ï¼‰ï¼šå°†å£°æ˜å’Œå®ç°å†™åˆ°åŒä¸€æ–‡ä»¶ä¸­ï¼Œå¹¶æ›´æ”¹åç¼€åä¸º `.hpp` 

```cpp title:person.hpp fix:1
#pragram once
#include <iostream>
using namespace std;

template<class T1, class T2>
class Person
{
public:
	Person(T1 name, T2 age);
	void showPerson();

public:
	T1 m_name;
	T2 m_age;
};

template<class T1, class T2>
Person<T1, T2>::Person(T1 name, T2 age)
{
	this->m_name = name;
	this->m_age = age;
}

template<class T1, class T2>
void Person<T1, T2>::showPerson()
{
	cout << this->m_name << this->m_age << endl;
}
```

>[!Note] 
> 
> `.hpp` æ˜¯çº¦å®šä¿—ç§°çš„åç¼€åï¼Œéå¼ºåˆ¶è¦æ±‚ï¼Œä½†ä¸€èˆ¬è§åˆ° `.hpp` å¯çŸ¥è¯¥æ–‡ä»¶ä¸ºæ¨¡æ¿å®ç°

```cpp title:test.cpp hl:4
#include <iostream>
using namespace std;

#include "person.hpp"

void test_func()
{
	Person<string, int> p("Mon", 10);
	p.showPerson();
}

int main()
{
	test_func();
	return 0;
}
```

>[!Summary] 
> 
> ä¸»æµçš„è§£å†³æ–¹å¼æ˜¯ç¬¬äºŒç§ï¼Œå°†ç±»å’Œæˆå‘˜å‡½æ•°å†™åˆ°ä¸€èµ·ï¼Œå¹¶å°†åç¼€åä¿®æ”¹ä¸º `.hpp`

#### 2.8 ç±»æ¨¡æ¿ä¸å‹å…ƒ

å…¨å±€å‡½æ•°ç±»å†…å®ç°ï¼šç›´æ¥åœ¨ç±»å†…å£°æ˜å‹å…ƒå³å¯

å…¨å±€å‡½æ•°ç±»å¤–å®ç°ï¼šéœ€è¦æå‰è®©ç¼–è¯‘å™¨çŸ¥é“å…¨å±€å‡½æ•°çš„å­˜åœ¨

```cpp hl:13,33-37 imp:19,2-3,5-6
/* å…¨å±€å‡½æ•°ç±»å¤–å®ç°éœ€æå‰å£°æ˜ç±»å’Œå…¨å±€å‡½æ•°, è®©ç¼–è¯‘å™¨çŸ¥é“è¯¥å…¨å±€å‡½æ•°çš„å­˜åœ¨ */
template<class T1, class T2>
class Person;

template<class T1, class T2>
void printPerson_ex(Person<T1, T2> p);

template<class T1, class T2>
class Person
{

	/* å…¨å±€å‡½æ•°ç±»å†…å®ç° */
	friend void printPerson(Person<T1, T2> p)
	{
		cout << p.m_name << p.m_age << endl;
	}

	/* å…¨å±€å‡½æ•°ç±»å¤–å®ç° - éœ€åŠ ç©ºå‚æ•°åˆ—è¡¨ <> */
	friend void printPerson_ex<>(Person<T1, T2> p);

public:
	Person(T1 name, T2 age)
	{
		this->m_name = name;
		this->m_age = age;
	}
	
private:
	T1 m_name;
	T2 m_age;
};

template<class T1, class T2>
void printPerson_ex(Person<T1, T2> p)
{
	cout << p.m_name << p.m_age << endl;
}

void test_func()
{
	Person<string, int> p("Mon", 10);
	
	printPerson(p);
	printPerson_ex(p);
}
```

>[!Summary] 
> 
> å»ºè®®å…¨å±€å‡½æ•°ç±»å†…å®ç°ï¼Œç”¨æ³•ç®€å•ï¼Œä¸”ç¼–è¯‘å™¨å¯ä»¥ç›´æ¥è¯†åˆ«

#### 2.9 ç±»æ¨¡æ¿æ¡ˆä¾‹ - æ•°ç»„ç±»å°è£…

æ¡ˆä¾‹æè¿°ï¼šå®ç°ä¸€ä¸ªé€šç”¨çš„æ•°ç»„ç±»ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

- å¯ä»¥å¯¹å†…ç½®æ•°æ®ç±»å‹ä»¥åŠè‡ªå®šä¹‰æ•°æ®ç±»å‹çš„æ•°æ®è¿›è¡Œå­˜å‚¨
- å°†æ•°ç»„ä¸­æ•°æ®å­˜å‚¨åˆ°å †åŒº
- æ„é€ å‡½æ•°ä¸­å¯ä»¥ä¼ å…¥æ•°ç»„çš„å®¹é‡
- æä¾›å¯¹åº”çš„æ‹·è´æ„é€ å‡½æ•°ä»¥åŠ `operate=` é˜²æ­¢æµ…æ‹·è´é—®é¢˜
- æä¾›å°¾æ’æ³•å’Œå°¾åˆ æ³•å¯¹æ•°ç»„ä¸­çš„æ•°æ®è¿›è¡Œå¢åŠ å’Œåˆ é™¤
- å¯ä»¥é€šè¿‡ä¸‹æ ‡çš„æ–¹å¼è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ 
- å¯ä»¥è·å–æ•°ç»„ä¸­å½“å‰å…ƒç´ ä¸ªæ•°å’Œæ•°ç»„çš„å®¹é‡

```cpp title:user_array.hpp

#ifndef __USER_ARRAY
#define __USER_ARRAY
#include <iostream>
using namespace std;

template<class T>
class userArray
{
public:

	/* æœ‰å‚æ„é€  */
	userArray(int capacity)
	{
		this->m_capacity = capacity;
		this->m_size = 0;
		this->p_address = new T[this->m_capacity];
	}

	/* æ‹·è´æ„é€  */
	userArray(const userArray& arr)
	{
		this->m_capacity = arr.m_capacity;
		this->m_size = arr.m_size;
		
		/* æ·±æ‹·è´ */
		this->p_address = new T[arr.m_capacity];
		for (int i =  0; i < this->m_size; i++)
		{
			this->p_address[i] = arr.p_address[i];
		}
	}

	/* è¿ç®—ç¬¦ `=` é‡è½½ */
	userArray& operator=(const userArray& arr)
	{
		/* æ¸…ç©ºåŸæœ¬æ•°æ® */
		if (this->p_address != NULL)
		{
			delete[] this->p_address;
			this->p_address = NULL;
			this->m_capacity = 0;
			this->m_size = 0;
		}

		/* æ·±æ‹·è´ */
		this->m_capacity = arr.m_capacity;
		this->m_size = arr.m_size;
		this->p_address = new T[arr.m_capacity];
		for (int i =  0; i < this->m_size; i++)
		{
			this->p_address[i] = arr.p_address[i];
		}

		return *this;
	}

	/* å°¾æ’æ³• */
	void pushBack(const T &val)
	{
		if (this->m_capacity == this->m_size)
		{
			return;
		}
		this->p_address[this->m_size] = val;
		this->m_size++;
	}

	/* å°¾åˆ æ³• */
	void popBack()
	{
		if (this->m_size == 0)
		{
			return;
		}
		this->m_size--;
	}

	/* é€šè¿‡ä¸‹æ ‡æ–¹å¼è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´  arr[0] = 10 */
	T& operator[](int index)
	{
		return this->p_address[index];
	} 

	/* è¿”å›å®¹é‡ */
	int getCapacity()
	{
		return this->m_capacity;
	}

	/* è¿”å›å¤§å° */
	int getSize()
	{
		return this->m_size;
	}

	/* ææ„ */
	~userArray()
	{
		if (this->p_address != NULL)
		{
			delete[] this->p_address;
			this->p_address = NULL;
		}
	}

private:

	T *p_address;   // åœ°å€
	int m_capacity; // å®¹é‡
	int m_size;     // å½“å‰å…ƒç´ ä¸ªæ•°
};
#endif /* __USER_ARRAY */
```

```cpp title:test.cpp
#include <iostream>
#include <string>
using namespace std;

#include "user_array.hpp"

class Person
{
	friend void printPersonArray(userArray<Person>& arr);

public:
	Person(){};
	Person(string name, int age)
	{
		this->m_name = name;
		this->m_age = age;
	}
	
private:
	string m_name;
	int m_age;
};

void printIntArray(userArray<int>& arr)
{
	for (int i = 0; i < arr.getSize(); i++)
	{
		cout << arr[i] << endl;
	}
}

void printPersonArray(userArray<Person>& arr)
{
	for (int i = 0; i < arr.getSize(); i++)
	{
		cout << "Name: " << arr[i].m_name;
		cout << " Age: " << arr[i].m_age << endl;
	}
}

void test1_func()
{
	userArray<int> arr1(5);

	/* å°¾æ’ */
	for (int i = 0; i < 5; i++)
	{
		arr1.pushBack(i);
	}

	/* ä¸‹æ ‡è®¿é—® */
	cout << "arr1 content: " << endl;
	printIntArray(arr1);

	/* å®¹é‡ï¼Œå¤§å° */
	cout << "arr1 capacity:" << arr1.getCapacity() << endl;
	cout << "arr2 size:" << arr1.getSize() << endl;

	/* æ‹·è´æ„é€  */
	userArray<int> arr2(arr1);

	cout << "arr2 content: " << endl;
	printIntArray(arr2);

	/* å°¾åˆ  */
	cout << "-> arr2 pop 1 item" << endl;
	arr2.popBack();

	cout << "arr2 content: " << endl;
	printIntArray(arr2);

	cout << "arr2 capacity:" << arr2.getCapacity() << endl;
	cout << "arr2 size:" << arr2.getSize() << endl;
}

void test2_func()
{
	userArray<Person> arr(10);

	Person p1("Mon", 10);
	Person p2("Tom", 12);
	Person p3("Anty", 11);
	Person p4("Bob", 17);
	Person p5("Farry", 15);

	arr.pushBack(p1);
	arr.pushBack(p2);
	arr.pushBack(p3);
	arr.pushBack(p4);
	arr.pushBack(p5);

	printPersonArray(arr);

	cout << "arr capacity: " << arr.getCapacity() << endl;
	cout << "arr size: " << arr.getSize() << endl;
}

int main()
{
	test1_func();
	test2_func();
	return 0;
}
```
