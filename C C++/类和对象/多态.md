---
id: 64245c1c-05bf-4f2b-905e-1798030f7224
title: å¤šæ€
aliases: 
author: SprInec
date: 2024-12-11
update: 2024-12-12 00:39:00
reference:
  - é»‘é©¬ç¨‹åºå‘˜C++æ•™ç¨‹
tags: cpp
---
# å¤šæ€

### 1. å¤šæ€çš„åŸºæœ¬æ¦‚å¿µ

å¤šæ€æ˜¯ C++ é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§ä¹‹ä¸€

å¤šæ€åˆ†ä¸ºä¸¤ç±»ï¼š

- é™æ€å¤šæ€ï¼šå‡½æ•°é‡è½½å’Œè¿ç®—ç¬¦é‡è½½å±äºé™æ€å¤šæ€ï¼Œå¤ç”¨å‡½æ•°å
- åŠ¨æ€å¤šæ€ï¼šæ´¾ç”Ÿç±»å’Œè™šå‡½æ•°å®ç°è¿è¡Œæ—¶å¤šæ€

é™æ€å¤šæ€å’ŒåŠ¨æ€å¤šæ€çš„åŒºåˆ«ï¼š

- é™æ€å¤šæ€çš„å‡½æ•°åœ°å€æ—©ç»‘å®š - ç¼–è¯‘é˜¶æ®µç¡®å®šå‡½æ•°åœ°å€
- åŠ¨æ€å¤šæ€çš„å‡½æ•°åœ°å€æ™šç»‘å®š - è¿è¡Œé˜¶æ®µç¡®å®šå‡½æ•°åœ°å€

å¤šæ€æ»¡è¶³æ¡ä»¶ï¼š

1. æœ‰ç»§æ‰¿å…³ç³»
2. å­ç±»**é‡å†™**çˆ¶ç±»**è™š**å‡½æ•°

>[!Note] 
> 
> **é‡å†™**ï¼šå‡½æ•°è¿”å›ç±»å‹ï¼Œå‡½æ•°åï¼Œå‚æ•°åˆ—è¡¨å®Œå…¨ä¸€è‡´ç§°ä¸ºé‡å†™

```cpp hl:4,13-16,22-25,29,38,42 imp:28,37,41
class Animal {
public:
	/* å‡½æ•°å‰åŠ å…³é”®å­— virtual å˜æˆè™šå‡½æ•°ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¸èƒ½ç¡®å®šå‡½æ•°åœ°å€ */
	virtual void yell()
	{
		cout << "animal yell" << endl;
	}
};

class Cat {
public:
	/* é‡å†™åŸºç±»æˆå‘˜å‡½æ•° */
	void yell() // ğŸ’¡ virtual å¯å†™å¯ä¸å†™
	{
		cout << "cat yell" << endl;
	}
};

class Dog {
public:
	/* é‡å†™åŸºç±»æˆå‘˜å‡½æ•° */
	virtual void yell() // ğŸ’¡ virtual å¯å†™å¯ä¸å†™
	{
		cout << "dog yell" << endl;
	}
};

/* å¤šæ€ä½¿ç”¨: çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ */
void doYell(Animal &animal)
{
	animal.yell();
}

void test_func()
{
	Cat cat;
	/* å¤šæ€ä½¿ç”¨: çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ */
	doYell(cat); // output: cat yell

	Dog dog;
	/* å¤šæ€ä½¿ç”¨: çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ */
	doYell(dog); // output: dog yell
}
```

>[!Important] 
> 
> **å¤šæ€ä½¿ç”¨**ï¼šçˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡
### 2. å¤šæ€çš„åŸç†å‰–æ

![[ESEJKC/C C++/ç±»å’Œå¯¹è±¡/å¤šæ€å›¾ä¾‹.md#^group=JvNC0W5N|900|center]]

### 3. å¤šæ€æ¡ˆä¾‹ - è®¡ç®—å™¨

ä¼ ç»Ÿå®ç°ï¼š

```cpp hl:6-14
class Calculator
{
public:
	int getResult(string oper)
	{
		if (oper == "+") {
			return (m_num1 + m_num2);
		}
		else if (oper == "-") {
			return (m_num1 - m_num2);
		}
		else if (oper == "*") {
			return (m_num1 * m_num2);
		}
		/* è‹¥æƒ³æ‰©å±•åŠŸèƒ½, éœ€ä¿®æ”¹æ­¤å¤„æºç  */
	}
public:
	int m_num1;
	int m_num2;
};

void test_func()
{
	Calculator cal;
	cal.m_num1 = 10;
	cal.m_num2 = 10;

	cout << cal.getResult("+") << endl;
	cout << cal.getResult("-") << endl;
	cout << cal.getResult("*") << endl;
}
```

>[!Tip] 
> 
> åœ¨å®é™…å¼€å‘ä¸­ï¼Œæå€¡**å¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•è¿›è¡Œå¼€æ”¾ï¼Œå¯¹ä¿®æ”¹è¿›è¡Œå…³é—­

å¤šæ€å®ç°ï¼š

```cpp hl:5,17,26,35,43,51,55 imp:42,48 fix:49,53,57
/* è®¡ç®—å™¨åŸºç±» */
class AbstractCalculator
{
public:
	virtual int getResult() {
		return 0;
	}
public:
	int m_num1;
	int m_num2;
};

/* åŠ æ³•è®¡ç®—å™¨ */
class AddCalculator: public AbstractCalculator
{
public:
	int getResult() {
		return (m_num1 + m_num2);
	}
};

/* å‡æ³•è®¡ç®—å™¨ */
class SubCalculator: public AbstractCalculator
{
public:
	int getResult() {
		return (m_num1 - m_num2);
	}
};

/* ä¹˜æ³•è®¡ç®—å™¨ */
class MulCalculator: public AbstractCalculator
{
public:
	int getResult() {
		return (m_num1 * m_num2);
	}
};

void test_func()
{
	/* å¤šæ€ä½¿ç”¨: çˆ¶ç±»æŒ‡é’ˆæŒ‡å‘å­ç±»å¯¹è±¡ */
	AbstractCalculator * absc = new AddCalculator;
	absc->m_num1 = 10;
	absc->m_num2 = 10;

	cout << absc->getResult() << endl;
	/* å †åŒºé‡Šæ”¾ */
	delete absc;

	absc = new SubCalculator;
	cout << absc->getResult() << endl;
	delete absc;

	absc = new MulCalculator;
	cout << absc->getResult() << endl;
	delete absc;
}
```

>[!Summary] 
> 
> **å¤šæ€çš„ä¼˜ç‚¹ï¼š**
> 1. ç»„ç»‡ç»“æ„æ¸…æ™°
> 2. å¯è¯»æ€§å¼º
> 3. å‰æœŸå’ŒåæœŸçš„æ‰©å±•æ€§åŠç»´æŠ¤æ€§é«˜
> 
>C++ å¼€å‘æå€¡åˆ©ç”¨å¤šæ€è®¾è®¡ç¨‹åºæ¶æ„    

### 4. çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»

åœ¨å¤šæ€ä¸­ï¼Œé€šå¸¸çˆ¶ç±»è™šå‡½æ•°çš„å®ç°æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œä¸»è¦éƒ½æ˜¯è°ƒç”¨å­ç±»é‡å†™çš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥å°†è™šå‡½æ•°æ”¹ä¸º**çº¯è™šå‡½æ•°**

çº¯è™šå‡½æ•°è¯­æ³•ï¼š`{cpp icon}virtual return_type funcName(parameter-list) = 0;`
- `return_type` è¿”å›å€¼ç±»å‹
- `funcName` å‡½æ•°å
- `parameter-list` å‚æ•°åˆ—è¡¨

å½“ç±»ä¸­æœ‰äº†çº¯è™šå‡½æ•°ï¼Œè¿™ä¸ªç±»ä¹Ÿæˆä¸º**æŠ½è±¡ç±»**

æŠ½è±¡ç±»ç‰¹ç‚¹ï¼š

- æ— æ³•å®ä¾‹åŒ–å¯¹è±¡
- å­ç±»å¿…é¡»é‡å†™æŠ½è±¡ç±»ä¸­çš„çº¯è™šå‡½æ•°ï¼Œå¦åˆ™ä¹Ÿå±äºæŠ½è±¡ç±»

```cpp hl:4,7,12
class Base
{
public:
	virtual void func() = 0; // çº¯è™šå‡½æ•°-æŠ½è±¡ç±»
};

class Sub1: public Base {};  // çº¯è™šå‡½æ•°-æŠ½è±¡ç±»

class Sub2: public Base 
{
public:
	void func() // å‡½æ•°é‡å†™
	{
		cout << "sub 2" << endl;
	}
};
```

### 5. å¤šæ€æ¡ˆä¾‹ - åˆ¶ä½œé¥®å“

```cpp hl:5,7,9,11,27-29,31-33,35-37,39-41,48-50,52-54,56-58,60-62,65,67,73-74 fix:68
class AbstractDrinking
{
public:
	/* ç…®æ°´ */
	virtual void boil() = 0;
	/* å†²æ³¡ */
	virtual void brew() = 0;
	/* å€’å…¥æ¯ä¸­ */
	virtual void pourInCup() = 0;
	/* åŠ å…¥ä½æ–™ */
	virtual void putInSomething() = 0;

	/* åˆ¶ä½œé¥®å“ */
	void makeDrinking()
	{
		boil();
		brew();
		pourInCup();
		putInSomething();	
	}
};

/* åˆ¶ä½œå’–å•¡ */
class Coffee: public AbstractDrinking
{
public:
	void boil() {
		cout << "boil water" << endl;
	} 
	
	void brew() {
		cout << "brewing coffee" << endl;
	}
	
	void pourInCup() {
		cout << "pour into cup" << endl;
	}
	
	void putInSomething() {
		cout << "add sugar and milk" << endl;
	}
};

/* åˆ¶ä½œèŒ¶æ°´ */
class Tea: public AbstractDrinking
{
public:
	void boil() {
		cout << "boil water" << endl;
	} 
	
	void brew() {
		cout << "brewing tea" << endl;
	}
	
	void pourInCup() {
		cout << "pour into cup" << endl;
	}
	
	void putInSomething() {
		cout << "add lemon" << endl;
	}
};

void doWork(AbstractDrinking * absd)
{
	absd->makeDrinking();
	delete absd; // å †åŒºé‡Šæ”¾
}

void test_func()
{
	doWork(new Coffee);
	doWork(new Tea);
}
```

### 6. è™šææ„å’Œçº¯è™šææ„

å¤šæ€ä½¿ç”¨æ—¶ï¼Œå¦‚æœå­ç±»ä¸­æœ‰å±æ€§å¼€è¾Ÿåˆ°å †åŒºï¼Œçˆ¶ç±»æŒ‡é’ˆåœ¨é‡Šæ”¾æ—¶æ— æ³•è°ƒç”¨åˆ°å­ç±»çš„ææ„ä»£ç 

è§£å†³æ–¹å¼ï¼šå°†çˆ¶ç±»ä¸­çš„ææ„å‡½æ•°æ”¹ä¸º**è™šææ„**æˆ–è€…**çº¯è™šææ„** 

è™šææ„å’Œçº¯è™šææ„å…±æ€§ï¼š

- å¯ä»¥è§£å†³çˆ¶ç±»æŒ‡é’ˆé‡Šæ”¾å­ç±»å¯¹è±¡ 
- éƒ½éœ€è¦æœ‰å…·ä½“çš„å‡½æ•°å®ç°

è™šææ„å’Œçº¯è™šææ„åŒºåˆ«ï¼šå¦‚æœæ˜¯çº¯è™šææ„ï¼Œè¯¥ç±»å±äºæŠ½è±¡ç±»ï¼Œæ— æ³•å®ä¾‹åŒ–å¯¹è±¡

```cpp

```


